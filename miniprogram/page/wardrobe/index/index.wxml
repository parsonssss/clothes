<view class="container" style="background-color: {{colors.golden_batter}};">
  <!-- Loading state -->
  <view class="loading-overlay" wx:if="{{isLoading}}" style="background-color: {{colors.golden_batter}};">
    <view class="loading-spinner" style="border-top-color: {{colors.cowhide_cocoa}}; border-color: {{colors.golden_batter}};"></view>
    <view class="loading-text" style="color: {{colors.cowhide_cocoa}};">加载中...</view>
  </view>
  
  <!-- Weather widget -->
  <view class="weather-widget" bindtap="viewWeatherDetail" style="background-color: {{colors.toasted_caramel}};">
    <view class="weather-info">
      <view class="weather-location" style="color: {{colors.golden_batter}};">{{weather.city}}，{{weather.day}}</view>
      <view class="weather-temp" style="color: {{colors.golden_batter}};">{{weather.temperature}}</view>
      <view class="weather-condition" style="color: {{colors.golden_batter}};">{{weather.condition}}</view>
    </view>
    <view class="weather-icon">
      <view class="weather-icon-img">
        <image wx:if="{{weather.iconUrl}}" src="{{weather.iconUrl}}" mode="aspectFit" class="weather-icon-image"></image>
        <view class="icon-sun" wx:elif="{{weather.icon == 'sun'}}" style="background-color: {{colors.golden_batter}};"></view>
        <view class="icon-cloud" wx:elif="{{weather.icon == 'cloud'}}" style="background-color: {{colors.golden_batter}};"></view>
        <view class="icon-rain" wx:elif="{{weather.icon == 'rain'}}" style="background-color: {{colors.golden_batter}};"></view>
      </view>
    </view>
  </view>
  
  <!-- OOTD and outfit area -->
  <view class="ootd-container">
    <!-- Model display -->
    <view class="section">
      <view class="section-header">
        <view class="section-title" style="color: {{colors.cowhide_cocoa}};">今日造型</view>
      </view>
      
      <view class="model-container" bindtap="uploadPersonalPhoto" style="border: 1px solid {{colors.olive_harvest}};">
        <image 
          wx:if="{{modelImageUrl}}"
          src="{{modelImageUrl}}"
          mode="aspectFill"
          class="model-image"
        ></image>
        <image 
          wx:else
          src="{{defaultModelUrl || '/image/default-model.png'}}"
          mode="aspectFill"
          class="model-image"
        ></image>
        <view class="model-upload-overlay" style="background-color: rgba(68, 45, 28, 0.7);">
          <view class="model-upload-text" style="color: {{colors.golden_batter}};">点击上传照片生成AI形象</view>
        </view>
      </view>
    </view>
    
    <!-- Recommended outfits -->
    <view class="section">
      <view class="section-header">
        <view class="section-title" style="color: {{colors.cowhide_cocoa}};">搭配推荐</view>
        <view class="recommend-button" bindtap="getOutfitRecommendation" wx:if="{{!isGeneratingOutfit && recommendedOutfit.length === 0}}" style="background-color: {{colors.spiced_wine}};">
          <text class="recommend-button-text" style="color: {{colors.golden_batter}};">获取推荐</text>
        </view>
      </view>
      
      <view class="outfit-cards">
        <block wx:if="{{recommendedOutfit.length > 0}}">
          <view class="outfit-card" wx:for="{{recommendedOutfit}}" wx:key="_id" bindtap="viewClothesDetail" data-id="{{item._id}}" style="background-color: {{colors.olive_harvest}};">
            <image 
              wx:if="{{item.tempImageUrl}}"
              src="{{item.tempImageUrl}}"
              mode="aspectFill"
              class="outfit-card-image"
            ></image>
            <view class="outfit-card-icon {{item.category == '上衣' ? 'tops' : (item.category == '裤子' ? 'pants' : (item.category == '外套' ? 'coat' : (item.category == '裙子' ? 'skirt' : 'jacket')))}}" wx:else style="color: {{colors.golden_batter}};"></view>
            <view class="outfit-card-info" style="background-color: rgba(132, 89, 43, 0.85);">
              <view class="outfit-card-name" style="color: {{colors.golden_batter}};">{{item.name || item.category}}</view>
              <view class="outfit-card-type" style="color: {{colors.golden_batter}};">{{item.clothingType || item.category}}</view>
            </view>
          </view>
        </block>
        
        <view class="thinking-container" wx:elif="{{isGeneratingOutfit}}" style="background-color: {{colors.olive_harvest}};">
          <view class="thinking-animation">
            <view class="thinking-dot" style="background-color: {{colors.golden_batter}};"></view>
            <view class="thinking-dot" style="background-color: {{colors.golden_batter}};"></view>
            <view class="thinking-dot" style="background-color: {{colors.golden_batter}};"></view>
          </view>
          <view class="thinking-text" style="color: {{colors.golden_batter}};">DeepSeek正在思考适合今天天气的搭配...</view>
        </view>
        
        <view class="empty-outfit" wx:else style="background-color: {{colors.olive_harvest}};">
          <view class="empty-outfit-text" style="color: {{colors.golden_batter}};">点击"获取推荐"按钮，基于天气获取最适合今天的穿搭建议</view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- Generation status indicator -->
  <view class="generating-status" wx:if="{{isGeneratingModel}}" style="background-color: rgba(68, 45, 28, 0.85);">
    <view class="generating-spinner" style="border-top-color: {{colors.golden_batter}}; border-color: rgba(232, 209, 167, 0.3);"></view>
    <view class="generating-text" style="color: {{colors.golden_batter}};">AI造型生成中...</view>
  </view>
</view>